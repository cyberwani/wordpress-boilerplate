# take a look at https://github.com/bueltge/WordPress-Starter/blob/master/.htaccess

#Alternate default index page
DirectoryIndex index.php index.html


# Redirect /admin and /login
RewriteRule ^admin/?$ /core/wp-admin/ [R,L]
RewriteRule ^login/?$ /core/wp-login.php [R,L]
RewriteRule ^core/?$ /core/wp-admin/ [R,L]
RewriteRule ^wp-admin/?$ /404 [R,L]
#RewriteRule ^admin/?$ /404 [R,L]
#RewriteRule ^login/?$ /404 [R,L]


# BEGIN WordPress
<IfModule mod_rewrite.c>
	RewriteEngine On
	RewriteBase /
	RewriteRule ^index\.php$ - [L]
	RewriteCond %{REQUEST_FILENAME} !-f
	RewriteCond %{REQUEST_FILENAME} !-d
	RewriteRule . /index.php [L]
</IfModule>

# END WordPress

# ----------------------------------------------------------------------
# Little more security in WP and htaccess protection
# ----------------------------------------------------------------------
# "-Indexes" will have Apache block users from browsing folders without a default document
# Usually you should leave this activated, because you shouldn't allow everybody to surf through
# every folder on your server (which includes rather private places like CMS system folders).
<IfModule mod_autoindex.c>
  Options -Indexes
</IfModule>

# Block access to "hidden" directories whose names begin with a period. This
# includes directories used by version control systems such as Subversion or Git.
<IfModule mod_rewrite.c>
  RewriteCond %{SCRIPT_FILENAME} -d
  RewriteCond %{SCRIPT_FILENAME} -f
  RewriteRule "(^|/)\." - [F]
</IfModule>

# Block access to backup and source files
# This files may be left by some text/html editors and
# pose a great security danger, when someone can access them
<FilesMatch "(\.(bak|config|sql|fla|psd|ini|log|sh|inc|swp|dist)|~)$">
	Order allow,deny
	Deny from all
	Satisfy All
</FilesMatch>

# PROTECT all htaccess files
<Files ~ "^[\._]ht">
  Order allow,deny
  Deny from all
  Satisfy All
</Files>

# PROTECT wp-configs
<Files ~ "^_?wp-config">
  Order allow,deny
  Deny from all
  Satisfy all
</files>

# PROTECT wp-login.php
#<files wp-login.php>
#  AuthName "Admin-Bereich"
#  AuthType Basic
#  AuthUserFile /www/htdocs/absolute_path/.htusers
#  require valid-user
#</files>

# PROTECT readme
<Files ~ "^(readme|README)">
  Order allow,deny
  Deny from all
  Satisfy all
</Files>

# PROTECT composer
<Files ~ "^composer">
  Order allow,deny
  Deny from all
  Satisfy all
</Files>

# PROTECT dot files
<Files ~ "^\.">
  Order allow,deny
  Deny from all
  Satisfy all
</files>


# Restrict php file execution in uploads folder
# <Directory "/var/www/wp-content/uploads/">
#   <Files "*.php">
#     Order Deny,Allow
#     Deny from All
#   </Files>
# </Directory>


# PROTECT against user enumeration
RewriteEngine On
RewriteCond %{QUERY_STRING} author=d
RewriteRule ^ /? [L,R=301]


# PROTECT against script injections
Options +FollowSymLinks
RewriteEngine On
RewriteCond %{QUERY_STRING} (<|%3C).*script.*(>|%3E) [NC,OR]
RewriteCond %{QUERY_STRING} GLOBALS(=|[|%[0-9A-Z]{0,2}) [OR]
RewriteCond %{QUERY_STRING} _REQUEST(=|[|%[0-9A-Z]{0,2})
RewriteRule ^(.*)$ index.php [F,L]


# PROTECT wp-includes folder
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /
  RewriteRule ^core/wp-admin/includes/ - [F,L]
  RewriteRule !^core/wp-includes/ - [S=3]
  RewriteRule ^core/wp-includes/[^/]+\.php$ - [F,L]
  RewriteRule ^core/wp-includes/js/tinymce/langs/.+\.php - [F,L]
  RewriteRule ^core/wp-includes/theme-compat/ - [F,L]
</IfModule>


# Require SSL
# SSLOptions +StrictRequire
# SSLRequireSSL
# SSLRequire %{HTTP_HOST} eq "www.you-site.com"
# ErrorDocument 403 https://www.your-site.com